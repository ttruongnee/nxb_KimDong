{"ast":null,"code":"var _s = $RefreshSig$();\n// useMaGiamGia.js\nimport { useState } from 'react';\nimport axios from 'axios';\nimport { useFetchData } from '../useFetchData'; // Đảm bảo đường dẫn đúng\n\n// Custom hook để quản lý logic liên quan đến mã giảm giá\nexport const useMaGiamGia = () => {\n  _s();\n  // State cho mã giảm giá mà người dùng nhập\n  const [discountCodeInput, setDiscountCodeInput] = useState('');\n  // State cho mã giảm giá hợp lệ (object dữ liệu từ API)\n  const [validDiscountCode, setValidDiscountCode] = useState(null);\n  // State cho phần trăm giảm giá\n  const [discountPercentage, setDiscountPercentage] = useState(0);\n  // State cho thông báo về mã giảm giá\n  const [discountMessage, setDiscountMessage] = useState('');\n\n  // Hàm xử lý khi giá trị input mã giảm giá thay đổi\n  const handleDiscountCodeInputChange = event => {\n    setDiscountCodeInput(event.target.value);\n    setDiscountMessage('');\n    setValidDiscountCode(null);\n    setDiscountPercentage(0);\n  };\n\n  // Hàm xử lý khi người dùng áp dụng mã giảm giá\n  const handleApplyDiscount = () => {\n    const enteredCode = discountCodeInput.trim().toUpperCase();\n    if (enteredCode) {\n      axios.get('http://localhost:3001/giamgias/').then(response => {\n        const discountCodeList = response.data;\n        const foundDiscountCode = discountCodeList.find(gg => gg.id.toUpperCase() === enteredCode);\n        if (foundDiscountCode) {\n          const currentDate = new Date();\n          const startDate = new Date(foundDiscountCode.ngaybatdau);\n          const endDate = new Date(foundDiscountCode.ngayketthuc);\n          if (currentDate >= startDate && currentDate <= endDate) {\n            setValidDiscountCode(foundDiscountCode);\n            setDiscountPercentage(foundDiscountCode.phantramgiamgia);\n            setDiscountMessage(`Áp dụng mã giảm giá ${enteredCode} thành công! Giảm ${foundDiscountCode.phantramgiamgia}%`);\n          } else if (currentDate < startDate) {\n            setValidDiscountCode(null);\n            setDiscountPercentage(0);\n            setDiscountMessage(`Mã giảm giá ${enteredCode} chưa đến thời gian áp dụng!`);\n          } else {\n            setValidDiscountCode(null);\n            setDiscountPercentage(0);\n            setDiscountMessage(`Mã giảm giá ${enteredCode} đã hết hạn!`);\n          }\n        } else {\n          setValidDiscountCode(null);\n          setDiscountPercentage(0);\n          setDiscountMessage(`Mã giảm giá ${enteredCode} không tồn tại!`);\n        }\n      }).catch(error => {\n        console.error('Lỗi khi lấy dữ liệu giảm giá:', error);\n        setValidDiscountCode(null);\n        setDiscountPercentage(0);\n        setDiscountMessage('Có lỗi xảy ra khi kiểm tra mã giảm giá.');\n      });\n    } else {\n      setValidDiscountCode(null);\n      setDiscountPercentage(0);\n      setDiscountMessage('Vui lòng nhập mã giảm giá.');\n    }\n  };\n  return {\n    discountCodeInput,\n    validDiscountCode,\n    discountPercentage,\n    discountMessage,\n    handleDiscountCodeInputChange,\n    handleApplyDiscount\n  };\n};\n_s(useMaGiamGia, \"5A/dLBhHtUbjI/6q8xQORb/EZCk=\");","map":{"version":3,"names":["useState","axios","useFetchData","useMaGiamGia","_s","discountCodeInput","setDiscountCodeInput","validDiscountCode","setValidDiscountCode","discountPercentage","setDiscountPercentage","discountMessage","setDiscountMessage","handleDiscountCodeInputChange","event","target","value","handleApplyDiscount","enteredCode","trim","toUpperCase","get","then","response","discountCodeList","data","foundDiscountCode","find","gg","id","currentDate","Date","startDate","ngaybatdau","endDate","ngayketthuc","phantramgiamgia","catch","error","console"],"sources":["D:/nxb_KimDong/fontend/user/src/component/payment/useGiamGia.js"],"sourcesContent":["// useMaGiamGia.js\r\nimport { useState } from 'react';\r\nimport axios from 'axios';\r\nimport { useFetchData } from '../useFetchData'; // Đảm bảo đường dẫn đúng\r\n\r\n\r\n// Custom hook để quản lý logic liên quan đến mã giảm giá\r\nexport const useMaGiamGia = () => {\r\n    // State cho mã giảm giá mà người dùng nhập\r\n    const [discountCodeInput, setDiscountCodeInput] = useState('');\r\n    // State cho mã giảm giá hợp lệ (object dữ liệu từ API)\r\n    const [validDiscountCode, setValidDiscountCode] = useState(null);\r\n    // State cho phần trăm giảm giá\r\n    const [discountPercentage, setDiscountPercentage] = useState(0);\r\n    // State cho thông báo về mã giảm giá\r\n    const [discountMessage, setDiscountMessage] = useState('');\r\n\r\n    // Hàm xử lý khi giá trị input mã giảm giá thay đổi\r\n    const handleDiscountCodeInputChange = (event) => {\r\n        setDiscountCodeInput(event.target.value);\r\n        setDiscountMessage('');\r\n        setValidDiscountCode(null);\r\n        setDiscountPercentage(0);\r\n    };\r\n\r\n    // Hàm xử lý khi người dùng áp dụng mã giảm giá\r\n    const handleApplyDiscount = () => {\r\n        const enteredCode = discountCodeInput.trim().toUpperCase();\r\n\r\n        if (enteredCode) {\r\n            axios.get('http://localhost:3001/giamgias/')\r\n                .then(response => {\r\n                    const discountCodeList = response.data;\r\n                    const foundDiscountCode = discountCodeList.find(gg => gg.id.toUpperCase() === enteredCode);\r\n\r\n                    if (foundDiscountCode) {\r\n                        const currentDate = new Date();\r\n                        const startDate = new Date(foundDiscountCode.ngaybatdau);\r\n                        const endDate = new Date(foundDiscountCode.ngayketthuc);\r\n\r\n                        if (currentDate >= startDate && currentDate <= endDate) {\r\n                            setValidDiscountCode(foundDiscountCode);\r\n                            setDiscountPercentage(foundDiscountCode.phantramgiamgia);\r\n                            setDiscountMessage(`Áp dụng mã giảm giá ${enteredCode} thành công! Giảm ${foundDiscountCode.phantramgiamgia}%`);\r\n                        } else if (currentDate < startDate) {\r\n                            setValidDiscountCode(null);\r\n                            setDiscountPercentage(0);\r\n                            setDiscountMessage(`Mã giảm giá ${enteredCode} chưa đến thời gian áp dụng!`);\r\n                        } else {\r\n                            setValidDiscountCode(null);\r\n                            setDiscountPercentage(0);\r\n                            setDiscountMessage(`Mã giảm giá ${enteredCode} đã hết hạn!`);\r\n                        }\r\n                    } else {\r\n                        setValidDiscountCode(null);\r\n                        setDiscountPercentage(0);\r\n                        setDiscountMessage(`Mã giảm giá ${enteredCode} không tồn tại!`);\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    console.error('Lỗi khi lấy dữ liệu giảm giá:', error);\r\n                    setValidDiscountCode(null);\r\n                    setDiscountPercentage(0);\r\n                    setDiscountMessage('Có lỗi xảy ra khi kiểm tra mã giảm giá.');\r\n                });\r\n        } else {\r\n            setValidDiscountCode(null);\r\n            setDiscountPercentage(0);\r\n            setDiscountMessage('Vui lòng nhập mã giảm giá.');\r\n        }\r\n    };\r\n\r\n    return {\r\n        discountCodeInput,\r\n        validDiscountCode,\r\n        discountPercentage,\r\n        discountMessage,\r\n        handleDiscountCodeInputChange,\r\n        handleApplyDiscount,\r\n    };\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}